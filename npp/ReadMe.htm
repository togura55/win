<!--このヘルプ ファイルの内容を表示するには、
ソリューション エクスプローラ ペインでファイルを右クリックし、
[ブラウザで表示] をクリックしてください。-->

<html><head><title>NPP サンプル : Windows メッセージ API (MAPI)</title></head><body><h1>NPP サンプル : Windows メッセージ API (MAPI)</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><h1 class="heading" >
  サンプル ファイル :
</h1><p /><p>NPP サンプルは、メモ帳に似たシングル ドキュメント インターフェイス (SDI: Single-Document Interface) アプリケーションです。テキストのメッセージを編集し、Windows メッセージ API (MAPI: Messaging API)、つまり MAPI を経由してほかのユーザーやシステムに送信できます。</p><p>Windows NT 4.0 を実行している場合は、サンプルを実行する前に MAPI がコンピュータにインストールされていることを確認してください。</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">セキュリティに関するメモ </th></tr><tr><td><p>このサンプル コードは概念を示す目的で提供されているものです。必ずしも最も安全なコーディング手法に従っているわけではないので、アプリケーションまたは Web サイトでは使用しないでください。Microsoft は、サンプル コードが意図しない目的で使用された場合に、付随的または間接的な損害について責任を負いません。</p></td></tr></table></div><h1 class="heading">サンプルのビルドと実行</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h3 class="subHeading">NPP サンプルをビルドおよび実行するには</h3><div class="subSection"><ol><li><p>ソリューション NPP.sln を開きます。 </p></li><li><p>[ビルド] メニューの [ビルド] をクリックします。 </p></li><li><p>[デバッグ] メニューの [デバッグなしで開始] をクリックします<b></b>。 </p></li></ol></div><p>[File] メニューの [Send] では、編集ウィンドウの内容を MAPI メッセージに添付できます。[Send] をクリックすると、まだ MAPI にログオンしていない場合は、MAPI セッションを開始するためのユーザー名とパスワードの入力を求められます。</p><p>この機能を有効にするには、リソース ファイルに選択したメニュー自体を追加する以外に、2 行のコードを追加することが必要です。この 2 行は、アプリケーションが管理する <b>CNotepadDoc</b> インスタンスに対するメッセージ マップのエントリです。これらのエントリは次のとおりです。</p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0">コードのコピー</span></th></tr><tr><td colspan="2"><pre>ON_COMMAND(ID_FILE_SEND_MAIL, OnFileSendMail)
ON_UPDATE_COMMAND_UI(ID_FILE_SEND_MAIL, OnUpdateFileSendMail)</pre></td></tr></table></span></div><p><MSHelp:link keywords="85545440-A581-4D7D-B950-DAE789AA9D3F" tabindex="0" >CDocument::OnFileSendMail</MSHelp:link> と <MSHelp:link keywords="2861C621-B49C-419F-AE89-10561CC2B62C" tabindex="0" >CDocument::OnUpdateFileSendMail</MSHelp:link> は MFC に組み込まれています。アプリケーションでこのレベルの MAPI サポートを実現する場合は、これだけで十分です。</p></div><h1 class="heading">キーワード</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>このサンプルでは、次のキーワードを使用します。</p><p>AfxGetMainWnd; AfxMessageBox; CComboBox::Copy; CComboBox::Create; CComboBox::GetDroppedState; CComboBox::Paste; CComboBox::SetEditSel; CComboBox::ShowDropDown; CDC::GetTextExtent; CDC::GetTextMetrics; CDC::SelectObject; CDialog::DoModal; CDialog::OnCancel; CDialog::OnInitDialog; CDocument::OnNewDocument; CEdit::GetLineCount; CEdit::LineFromChar; CEdit::LineIndex; CEdit::LineScroll; CEdit::SetSel; CEditView::GetEditCtrl; CEditView::GetSelectedText; CEditView::OnFindNext; CFrameWnd::Create; CFrameWnd::DockControlBar; CFrameWnd::EnableDocking; CFrameWnd::GetActiveView; CFrameWnd::RecalcLayout; CObject::AssertValid; CObject::Dump; CObject::Serialize; CRect::Height; CStatusBar::CommandToIndex; CStatusBar::SetPaneText; CString::Format; CString::GetLength; CString::LoadString; CToolBar::GetItemRect; CToolBar::SetButtonInfo; CView::GetDocument; CView::OnBeginPrinting; CView::OnDraw; CView::OnEndPrinting; CView::OnPreparePrinting; CWinApp::AddDocTemplate; CWinApp::InitInstance; CWinApp::LoadStdProfileSettings; CWinApp::OnFileNew; CWinApp::OnIdle; CWinApp::OpenDocumentFile; CWnd::Create; CWnd::DoDataExchange; CWnd::FromHandle; CWnd::GetDescendantWindow; CWnd::GetDlgItem; CWnd::GetFocus; CWnd::GetStyle; CWnd::GetWindowRect; CWnd::GetWindowText; CWnd::GetWindowTextLength; CWnd::KillTimer; CWnd::OnClose; CWnd::OnCreate; CWnd::PostMessage; CWnd::PreTranslateMessage; CWnd::ScreenToClient; CWnd::SendMessage; CWnd::SetFocus; CWnd::SetFont; CWnd::SetTimer; CWnd::SetWindowPos; CWnd::SetWindowText; CWnd::ShowWindow; CreateFontIndirect; DragAcceptFiles; EndDialog; EnumFontFamilies; GetDlgItem; GetKeyState; GetLocalTime; GetStockObject; LoadBitmap; MessageBeep; SendMessage; SetWindowText; memcpy</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">メモ </th></tr><tr><td><p>このサンプルを含む一部のサンプルには、Visual C++ のウィザード、ライブラリ、およびコンパイラの変更が反映されていませんが、必要なタスクを実行する方法は示されています。 </p></td></tr></table></div></div><h1 class="heading"><span id="seeAlsoNoToggle">参照</span></h1></div><div id="footer"><div class="footerLine"></div>
        このトピックについてのご提案や障害報告をお送りいただく場合は、<a href="http://go.microsoft.com/fwlink/?linkid=53178">こちら</a>を参照してください。
      </div></div></body></html>
